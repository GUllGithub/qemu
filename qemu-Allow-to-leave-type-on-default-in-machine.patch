--- qemu-kvm-0.15.0.old/vl.c	2011-08-09 13:40:29.000000000 +0100
+++ qemu-kvm-0.15.0/vl.c	2011-08-18 16:38:51.487515037 +0100
@@ -2718,7 +2718,10 @@
                     fprintf(stderr, "parse error: %s\n", optarg);
                     exit(1);
                 }
-                machine = machine_parse(qemu_opt_get(opts, "type"));
+                optarg = qemu_opt_get(opts, "type");
+                if (optarg) {
+                    machine = machine_parse(optarg);
+                }
                 break;
 	    case QEMU_OPTION_no_kvm:
                 olist = qemu_find_opts("machine");
